# Explore writing Jupyter Notebooks with the Basilisp Kernel

[Basilisp](https://github.com/basilisp-lang/basilisp) is a Lisp implementation broadly compatible with Clojure, running on the Python VM. Refer to the [documentation](https://basilisp.readthedocs.io/en/latest/index.html) to get started.

## Overview

This repository helps you explore writing [Jupyter](https://jupyter.org/) Notebooks in [Basilisp](https://basilisp.readthedocs.io/en/latest/index.html) Clojure using the [basilisp-kernel](https://github.com/ikappaki/basilisp-kernel).

It assumes you have some familiarity with [Clojure](https://clojure.org/guides/learn/clojure) and Jupyter Notebooks in Python.

It leverages the Poetry build tool to create a Python virtual environment that includes both the `Jupyter Notebook` and the `basilisp-kernel` dependencies to get you started. 

Additionally, it includes a sample Basilisp Application library (`basapp`) that can be loaded into the development notebook.

## Prerequisites

Ensure you have [Poetry](https://python-poetry.org/docs/) installed to manage the Python virtual environment.

## Project Setup

First, clone the repository locally
```
git clone https://github.com/ikappaki/basilex-notebook.git
```

Before running the project for the first time, install the dependencies in a new virtual environment by running
```shell
poetry install
```

You can add additional Python or Basilisp libraries at any time using the `add` command. For example to install `matplotlib`
```shell
poetry add matplotlib
```

## Usage

Activate the virtual environment by running
```shell
poetry shell
```

Then, start the Jupyter Notebook server
```shell
jupyter notebook
```

This should open the Jupyter Notebook home page in your browser. Open the `dev.ipynb` tutorial notebook to begin interacting with it.

The [src/basapp/core.lpy](src/basapp/core.lpy) path is automatically included in the python `sys.path` through `poetry install` ran at project setup. You can require it in the notebooks as normal
```clojure
[1] (require '[basapp.core :as bc])

[2] (bc/hello)
:Hi 👋 The Basilisp Kernel supports autocompletion of functions and variables using the Tab key ⌨️. Give it a go!
```

## Start Developing Using the nREPL Server

Refer to [Connecting Your Editor to the nREPL Server](https://github.com/ikappaki/basilex-notebook/wiki/Connecting-Your-Editor-to-the-nREPL-Server) for detailed instructions, covering various use cases.

#### Start the nREPL server

The following instructions are assumed to be executed in Notebook cells running the Basilisp Kernel, as indicated by the `[n]:` prefix.

First load the nREPL server namespace

```clojure
[n]: (require '[basilisp-kernel.nrepl-server :as nrepl-server])
```

Then, you can start the nREPL server

- Specify a fixed port with `:port`
```clojure
[n]: (def server (server-start {:port 9998}))
nREPL server started on port 9998 on host 127.0.0.1 - nrepl://127.0.0.1:9998
#'user/server
```

#### Connect to the nREPL Server

Open the `basilisp.edn` file in the root of your project to enable Clojure-specific features in your editor.

Then use your Editor's Clojure nREPL commands to connect to the server.

Both [Emacs/CIDER](https://docs.cider.mx/cider/platforms/basilisp.html) and [VSCode/Calva](https://calva.io/basilisp/) offer explicit support for Basilisp.

To connect

##### CIDER (Emacs)

1. Run `M-x cider-connect-clj`.
2. Select `localhost`.
3. Enter the port number from the nREPL server output.

##### Calva (VSCode)

1. Press `Ctrl-Shift-P` to open the Command Palette.
2. Select `Calva: Connect to a Running REPL Server, not in your project`>`basilisp`.
3. Enter the port number from the nREPL server output.


You should now be connected to the Basilisp notebook from your editor. Follow the `dev.ipynb` nREPL sectio of the tutorial to explore and try out a few cool nREPL interactions.

## Project Anatomy

```
.
├── basilisp.edn             (B)
├── dev.ipynb                (1)
├── poetry.lock              (2)
├── pyproject.toml           (3)
├── src
│   ├── basapp               (N)
│   │   └── core.lpy         (4)

```

🄑 An empty file indicating to Clojure-enabled editors that this is a Basilisp Project.

🄝 The root of the sample Basilisp App namespace.

① The development Notebook set up to use the `basilisp-kernel`.

② A lock file generated by Poetry that records the exact versions of dependencies installed.

③ The configuration file where project metadata, dependencies, and Poetry settings are defined.

④ The core namespace of the sample Basilisp App.
